version: '3'
services:
  health_cards:
    build:
      context: .
    environment:
      - RAILS_LOG_TO_STDOUT=true
      - SECRET_KEY_BASE="${HEALTH_CARDS_SECRET_KEY_BASE}"
      - HOST="${HEALTH_CARDS_HOST}"
      # This needs to be port 80 for the QR to show up in the pdf
      - PORT=80
    expose:
      - "80"
  nginx:
    image: nginx
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    ports:
      - "80:80"
      - "443:443"
    # Debug Mode
    command: [nginx, '-g', 'daemon off;']